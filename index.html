<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Web3 Payment CAC & Profit Allocation Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { background:#f7fafc }
    .card { background: white; border-radius: 12px; padding: 18px; box-shadow: 0 6px 18px rgba(15,23,42,0.08); }
    .small { font-size: 0.85rem; color: #475569 }
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
  </style>
</head>
<body class="p-6">
  <div class="max-w-6xl mx-auto">
    <header class="mb-6">
      <h1 class="text-2xl font-semibold">Web3 Payment CAC & Profit Allocation Calculator</h1>
      <p class="small mt-1">Estimate customer acquisition costs across channels, project revenue & profits, and allocate profit to budgets (treasury, incentives, ops, growth).</p>
    </header>

    <!-- How to Use Guide -->
    <section class="card mb-6">
      <h2 class="font-medium text-lg">How to Use This Tool (CEO Guide)</h2>
      <ol class="list-decimal pl-6 small mt-2 space-y-2">
        <li><strong>Set your time horizon:</strong> Enter the number of months (e.g., 12 for one year).</li>
        <li><strong>Enter customer targets:</strong> Add the number of new customers you want to acquire in that period.</li>
        <li><strong>Revenue assumptions:</strong> Input your ARPU (average revenue per user per year) and gross margin %.</li>
        <li><strong>Acquisition strategy:</strong> For each channel (partnerships, community, incentives, paid ads), input your monthly spend and estimated CAC. The calculator will estimate how many customers each channel will bring.</li>
        <li><strong>Profit allocation:</strong> Decide what % of net profit you want to allocate to Treasury, Incentives, Ops, R&D, and Marketing. Totals don’t have to be 100% — any leftover is shown separately.</li>
        <li><strong>Click Calculate:</strong> Review the revenue, CAC, and net profit results on the right panel. The pie chart shows your allocation visually.</li>
        <li><strong>Export to CSV:</strong> Download the results for sharing with your finance team or board.</li>
        <li><strong>Run scenarios:</strong> Adjust inputs (e.g., increase community spend, lower CAC assumptions) to test how strategies impact your blended CAC and profits.</li>
      </ol>
      <p class="small mt-3 text-gray-600">Tip: Focus on channels with the lowest CAC to bring down blended costs. Use the allocation sliders to reflect your company’s strategic priorities (e.g., heavier incentives during growth, more treasury in later stages).</p>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <section class="card">
        <h2 class="font-medium">Inputs</h2>
        <p class="small mb-4">Change the inputs to match your business. Default values are examples for a Web3 payment network.</p>

        <div class="space-y-4">
          <div>
            <label class="block small">Time period (months)</label>
            <input id="period" type="number" value="12" class="w-28 mt-1 p-2 border rounded" />
          </div>

          <div>
            <label class="block small">New users (customers) target</label>
            <input id="newCustomers" type="number" value="10000" class="w-48 mt-1 p-2 border rounded" />
          </div>

          <div>
            <label class="block small">Average Revenue per User (ARPU) / year (USD)</label>
            <input id="arpu" type="number" value="150" class="w-48 mt-1 p-2 border rounded" />
          </div>

          <div>
            <label class="block small">Gross margin (%)</label>
            <input id="grossMargin" type="number" value="60" class="w-28 mt-1 p-2 border rounded" />
          </div>

          <hr class="my-3" />

          <h3 class="font-medium">Marketing & Acquisition Channels (monthly spend and expected CAC)</h3>
          <p class="small">Enter monthly spend per channel and expected CAC (USD per new customer acquired by that channel).</p>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div>
              <label class="small">Partnerships monthly spend</label>
              <input id="spend_partnerships" type="number" value="15000" class="w-full mt-1 p-2 border rounded" />
              <label class="small mt-1">Expected CAC (partnerships)</label>
              <input id="cac_partnerships" type="number" value="200" class="w-full mt-1 p-2 border rounded" />
            </div>

            <div>
              <label class="small">Community & content monthly spend</label>
              <input id="spend_community" type="number" value="5000" class="w-full mt-1 p-2 border rounded" />
              <label class="small mt-1">Expected CAC (community)</label>
              <input id="cac_community" type="number" value="50" class="w-full mt-1 p-2 border rounded" />
            </div>

            <div>
              <label class="small">Incentives & subsidies monthly spend</label>
              <input id="spend_incentives" type="number" value="30000" class="w-full mt-1 p-2 border rounded" />
              <label class="small mt-1">Expected CAC (incentives)</label>
              <input id="cac_incentives" type="number" value="120" class="w-full mt-1 p-2 border rounded" />
            </div>

            <div>
              <label class="small">Paid ads & events monthly spend</label>
              <input id="spend_paid" type="number" value="8000" class="w-full mt-1 p-2 border rounded" />
              <label class="small mt-1">Expected CAC (paid)</label>
              <input id="cac_paid" type="number" value="150" class="w-full mt-1 p-2 border rounded" />
            </div>
          </div>

          <hr class="my-3" />

          <h3 class="font-medium">Operational & Treasury Allocation (% of net profit)</h3>
          <p class="small">Set target allocation percentages (they will scale from net profit). Totals should sum to 100% or you can leave spare cash.</p>

          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="small">Treasury / reserves (%)</label>
              <input id="alloc_treasury" type="number" value="30" class="w-full mt-1 p-2 border rounded" />
            </div>
            <div>
              <label class="small">Incentives & growth (%)</label>
              <input id="alloc_incentives" type="number" value="25" class="w-full mt-1 p-2 border rounded" />
            </div>
            <div>
              <label class="small">Operations & compliance (%)</label>
              <input id="alloc_ops" type="number" value="20" class="w-full mt-1 p-2 border rounded" />
            </div>
            <div>
              <label class="small">Product & R&D (%)</label>
              <input id="alloc_rnd" type="number" value="15" class="w-full mt-1 p-2 border rounded" />
            </div>
            <div>
              <label class="small">Marketing & biz dev (%)</label>
              <input id="alloc_marketing" type="number" value="10" class="w-full mt-1 p-2 border rounded" />
            </div>
          </div>

          <div class="mt-4">
            <button id="calcBtn" class="px-4 py-2 bg-blue-600 text-white rounded">Calculate</button>
            <button id="resetBtn" class="ml-2 px-4 py-2 border rounded">Reset to defaults</button>
          </div>
        </div>
      </section>

      <section class="card">
        <h2 class="font-medium">Results & Allocation</h2>
        <div id="results" class="mt-3 space-y-3 small">
          <!-- results injected here -->
        </div>

        <canvas id="allocationChart" height="220"></canvas>

        <div class="mt-4">
          <button id="exportCsv" class="px-3 py-2 border rounded">Export results CSV</button>
        </div>
      </section>
    </div>

    <footer class="mt-6 small text-gray-600">Built for CEOs and finance leads: modify inputs, test scenarios (A/B incentive strategies), and observe how CAC and allocations change. Defaults are illustrative — replace them with your company numbers.</footer>
  </div>

<script>
function number(v){ return parseFloat(v)||0 }

const defaults = {
  period:12, newCustomers:10000, arpu:150, grossMargin:60,
  spend_partnerships:15000, cac_partnerships:200,
  spend_community:5000, cac_community:50,
  spend_incentives:30000, cac_incentives:120,
  spend_paid:8000, cac_paid:150,
  alloc_treasury:30, alloc_incentives:25, alloc_ops:20, alloc_rnd:15, alloc_marketing:10
}

function setDefaults(){
  for(const k in defaults){ const el=document.getElementById(k); if(el) el.value=defaults[k] }
}
setDefaults()

function calculate(){
  const period = number(document.getElementById('period').value)
  const newCustomersTarget = number(document.getElementById('newCustomers').value)
  const arpu = number(document.getElementById('arpu').value)
  const grossMarginPct = number(document.getElementById('grossMargin').value)/100

  const channels = ['partnerships','community','incentives','paid']
  let totalMonthlySpend = 0
  let totalAcquired = 0
  const channelDetails = {}
  channels.forEach(c=>{
    const spend = number(document.getElementById('spend_'+c).value)
    const cac = number(document.getElementById('cac_'+c).value)
    totalMonthlySpend += spend
    const acquiredMonthly = cac>0? Math.floor(spend / cac) : 0
    channelDetails[c] = {spend,cac,acquiredMonthly}
    totalAcquired += acquiredMonthly
  })

  const totalSpend = totalMonthlySpend * period
  const acquired = totalAcquired * period
  const target = newCustomersTarget
  let shortfall = target - acquired
  let blendedCAC = acquired>0 ? totalSpend / acquired : 0

  let extraSpendToHitTarget=0
  if(shortfall>0 && blendedCAC>0){ extraSpendToHitTarget = shortfall * blendedCAC }

  const revenuePerCustomerPeriod = arpu * (period/12)
  const totalRevenue = target * revenuePerCustomerPeriod
  const grossProfit = totalRevenue * grossMarginPct
  const totalCAC = totalSpend + extraSpendToHitTarget
  const totalCACperCustomer = target>0? (totalCAC/target) : 0
  const netProfit = grossProfit - totalCAC

  const alloc = {
    treasuryPct:number(document.getElementById('alloc_treasury').value),
    incentivesPct:number(document.getElementById('alloc_incentives').value),
    opsPct:number(document.getElementById('alloc_ops').value),
    rndPct:number(document.getElementById('alloc_rnd').value),
    marketingPct:number(document.getElementById('alloc_marketing').value)
  }
  const allocations = {
    treasury: netProfit * (alloc.treasuryPct/100),
    incentives: netProfit * (alloc.incentivesPct/100),
    ops: netProfit * (alloc.opsPct/100),
    rnd: netProfit * (alloc.rndPct/100),
    marketing: netProfit * (alloc.marketingPct/100)
  }
  const leftover = netProfit - Object.values(allocations).reduce((a,b)=>a+b,0)

  return {period,target,totalSpend,acquired,blendedCAC,extraSpendToHitTarget,totalRevenue,grossProfit,totalCAC,totalCACperCustomer,netProfit,channelDetails,allocations,leftover}
}

function render(){
  const r = calculate()
  const out = document.getElementById('results')
  function safe(val){ return isNaN(val)?0:val }
  out.innerHTML = `
    <div><strong>Period:</strong> ${r.period} months</div>
    <div><strong>Target customers:</strong> ${r.target.toLocaleString()}</div>
    <div><strong>Total projected revenue:</strong> $${safe(r.totalRevenue).toLocaleString()}</div>
    <div><strong>Gross profit (after COGS):</strong> $${safe(r.grossProfit).toLocaleString()}</div>
    <div><strong>Total acquisition spend (period):</strong> $${safe(r.totalSpend).toLocaleString()}</div>
    <div><strong>Estimated
